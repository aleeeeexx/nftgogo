(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mobileLogin"],{"1b7c":function(e,t,c){"use strict";c("9c59")},"291c":function(e,t,c){"use strict";c.d(t,"a",(function(){return i})),c.d(t,"b",(function(){return s}));c("ac1f"),c("5319");var n=c("9ab4"),o=c("ea9b"),a=c("6c02"),r=function(e,t){return Object(n["b"])(void 0,void 0,void 0,(function(){var c;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return[4,Object(o["b"])(e,t)];case 1:return c=n.sent(),[2,c]}}))}))},l=function(e){return Object(n["b"])(void 0,void 0,void 0,(function(){var t;return Object(n["c"])(this,(function(c){switch(c.label){case 0:return[4,Object(o["f"])(e)];case 1:return t=c.sent(),[2,t]}}))}))},i=function(e){var t=e.externalUserId,c=e.mobile,n=e.userId,o=e.accessToken,a=e.refreshToken;t&&localStorage.setItem("externalUserId",t),c&&localStorage.setItem("mobile",c),n&&localStorage.setItem("userId",n),o&&localStorage.setItem("access_token",o),a&&localStorage.setItem("refreshToken",a)},s=function(e,t,c){return Object(n["b"])(void 0,void 0,void 0,(function(){var o,s,u,b,d,v,m;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return e&&t?(o=Object(a["e"])(),[4,r(e,t)]):[2,!1];case 1:if(s=n.sent(),i(s),localStorage.setItem("companyCode",t),localStorage.setItem("pulin_token",e),u=localStorage.getItem("mobile"),b=localStorage.getItem("userId"),d=localStorage.getItem("externalUserId"),v=localStorage.getItem("refreshToken"),!(s.mobile===u&&d&&v&&b))return[3,6];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,l({externalUserId:d,userId:b,refreshToken:v})];case 3:return m=n.sent(),i(Object.assign(m,{mobile:u})),[3,5];case 4:return n.sent(),o.replace({path:"/mobile-login",query:{mobile:s.mobile,redirect:encodeURIComponent(c)}}),[3,5];case 5:return[3,7];case 6:console.log("useRouter(): ",o),o.replace({path:"/mobile-login",query:{mobile:s.mobile,redirect:encodeURIComponent(c)}}),n.label=7;case 7:return[2,!0]}}))}))}},"9c59":function(e,t,c){},e367:function(e,t,c){"use strict";c.r(t);c("ac1f"),c("5319");var n=c("9ab4"),o=c("7a23"),a=c("6c02"),r=c("ea9b"),l=c("291c"),i=c("626a");Object(o["pushScopeId"])("data-v-0c394c8a");var s={class:"login"},u=Object(o["createElementVNode"])("div",{class:"title"},"验证码登录",-1),b={class:"con"},d={class:"input-box"},v={class:"input-box code"};Object(o["popScopeId"])();var m=Object(o["defineComponent"])({setup:function(e){var t=this,c=Object(a["e"])(),m=Object(a["d"])(),f=Object(o["ref"])("18289755297"),j=Object(o["ref"])("123"),O=Object(o["ref"])(!1),p=Object(o["ref"])(60),g=function(){return Object(n["b"])(t,void 0,void 0,(function(){var e;return Object(n["c"])(this,(function(t){switch(t.label){case 0:return O.value?[2]:[4,Object(r["d"])(f.value)];case 1:return e=t.sent(),console.log(e),j.value=e.message,Object(i["a"])("验证码已发送"),O.value=!0,h(),[2]}}))}))},I=0,h=function(){p.value=60,I=setInterval((function(){p.value>0?p.value--:(clearInterval(I),I=0,O.value=!1)}),1e3)},S=function(){return Object(n["b"])(t,void 0,void 0,(function(){var e;return Object(n["c"])(this,(function(t){switch(t.label){case 0:return[4,Object(r["e"])({phone:f.value,verifyCode:j.value})];case 1:return e=t.sent(),console.log(e),e.phone&&(Object(l["a"])(e),c.replace("/personal-center")),console.log(localStorage.getItem("access_token"),"getItem"),console.log(decodeURIComponent(m.query.redirect)),[2]}}))}))};return Object(o["onBeforeUnmount"])((function(){I&&clearInterval(I)})),function(e,t){var c=Object(o["resolveComponent"])("van-field");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",s,[u,Object(o["createElementVNode"])("div",b,[Object(o["createElementVNode"])("div",d,[Object(o["createVNode"])(c,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return f.value=e}),modelModifiers:{trim:!0},label:"",type:"tel",placeholder:"请输入手机号",maxlength:11},null,8,["modelValue"])]),Object(o["createElementVNode"])("div",v,[Object(o["createVNode"])(c,{modelValue:j.value,"onUpdate:modelValue":t[1]||(t[1]=function(e){return j.value=e}),modelModifiers:{trim:!0},label:"",type:"tel",placeholder:"请输入验证码",maxlength:6},null,8,["modelValue"]),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(["code-btn",{active:!O.value}]),onClick:g},Object(o["toDisplayString"])(O.value?p.value+"s后重新获取":"获取验证码"),3)]),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(["btn-wrap",{"active-login":j.value.length>3}]),onClick:S}," 登录 ",2)])])}}});c("1b7c");m.__scopeId="data-v-0c394c8a";t["default"]=m}}]);
//# sourceMappingURL=mobileLogin.e1ea8475.js.map