(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mobileLogin"],{"291c":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var o=n("9ab4"),c=n("ea9b"),r=n("6c02"),l=function(e,t){return Object(o["b"])(void 0,void 0,void 0,(function(){var n;return Object(o["c"])(this,(function(o){switch(o.label){case 0:return[4,Object(c["b"])(e,t)];case 1:return n=o.sent(),[2,n]}}))}))},a=function(e){return Object(o["b"])(void 0,void 0,void 0,(function(){var t;return Object(o["c"])(this,(function(n){switch(n.label){case 0:return[4,Object(c["f"])(e)];case 1:return t=n.sent(),[2,t]}}))}))},i=function(e){var t=e.externalUserId,n=e.mobile,o=e.userId,c=e.accessToken,r=e.refreshToken;t&&localStorage.setItem("externalUserId",t),n&&localStorage.setItem("mobile",n),o&&localStorage.setItem("userId",o),c&&localStorage.setItem("access_token",c),r&&localStorage.setItem("refreshToken",r)},s=function(e,t,n){return Object(o["b"])(void 0,void 0,void 0,(function(){var c,s,u,b,d,v,m;return Object(o["c"])(this,(function(o){switch(o.label){case 0:return e&&t?(c=Object(r["e"])(),[4,l(e,t)]):[2,!1];case 1:if(s=o.sent(),i(s),localStorage.setItem("companyCode",t),localStorage.setItem("pulin_token",e),u=localStorage.getItem("mobile"),b=localStorage.getItem("userId"),d=localStorage.getItem("externalUserId"),v=localStorage.getItem("refreshToken"),!(s.mobile===u&&d&&v&&b))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,a({externalUserId:d,userId:b,refreshToken:v})];case 3:return m=o.sent(),i(Object.assign(m,{mobile:u})),[3,5];case 4:return o.sent(),c.replace({path:"/mobile-login",query:{mobile:s.mobile,redirect:encodeURIComponent(n)}}),[3,5];case 5:return[3,7];case 6:console.log("useRouter(): ",c),c.replace({path:"/mobile-login",query:{mobile:s.mobile,redirect:encodeURIComponent(n)}}),o.label=7;case 7:return[2,!0]}}))}))}},"6b8b":function(e,t,n){},e367:function(e,t,n){"use strict";n.r(t);var o=n("9ab4"),c=n("7a23"),r=n("6c02"),l=n("ea9b"),a=n("291c"),i=n("626a");Object(c["pushScopeId"])("data-v-3124f26b");var s={class:"login"},u=Object(c["createElementVNode"])("div",{class:"title"},"验证码登录",-1),b={class:"con"},d={class:"input-box"},v={class:"input-box code"};Object(c["popScopeId"])();var m=Object(c["defineComponent"])({setup:function(e){var t=this,n=Object(r["e"])(),m=Object(r["d"])(),f=Object(c["ref"])("18289755297"),j=Object(c["ref"])("123"),O=Object(c["ref"])(!1),p=Object(c["ref"])(60),g=function(){return Object(o["b"])(t,void 0,void 0,(function(){var e;return Object(o["c"])(this,(function(t){switch(t.label){case 0:return O.value?[2]:[4,Object(l["d"])(f.value)];case 1:return e=t.sent(),console.log(e),j.value=e.message,Object(i["a"])("验证码已发送"),O.value=!0,h(),[2]}}))}))},I=0,h=function(){p.value=60,I=setInterval((function(){p.value>0?p.value--:(clearInterval(I),I=0,O.value=!1)}),1e3)},S=function(){return Object(o["b"])(t,void 0,void 0,(function(){var e;return Object(o["c"])(this,(function(t){switch(t.label){case 0:return[4,Object(l["e"])({phone:f.value,verifyCode:j.value})];case 1:return e=t.sent(),console.log(e),e.phone&&(Object(a["a"])(e),n.replace("/index")),console.log(localStorage.getItem("access_token"),"getItem"),console.log(decodeURIComponent(m.query.redirect)),[2]}}))}))};return Object(c["onBeforeUnmount"])((function(){I&&clearInterval(I)})),function(e,t){var n=Object(c["resolveComponent"])("van-field");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",s,[u,Object(c["createElementVNode"])("div",b,[Object(c["createElementVNode"])("div",d,[Object(c["createVNode"])(n,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return f.value=e}),modelModifiers:{trim:!0},label:"",type:"tel",placeholder:"请输入手机号",maxlength:11},null,8,["modelValue"])]),Object(c["createElementVNode"])("div",v,[Object(c["createVNode"])(n,{modelValue:j.value,"onUpdate:modelValue":t[1]||(t[1]=function(e){return j.value=e}),modelModifiers:{trim:!0},label:"",type:"tel",placeholder:"请输入验证码",maxlength:6},null,8,["modelValue"]),Object(c["createElementVNode"])("div",{class:Object(c["normalizeClass"])(["code-btn",{active:!O.value}]),onClick:g},Object(c["toDisplayString"])(O.value?p.value+"s后重新获取":"获取验证码"),3)]),Object(c["createElementVNode"])("div",{class:Object(c["normalizeClass"])(["btn-wrap",{"active-login":j.value.length>3}]),onClick:S}," 登录 ",2)])])}}}),f=(n("f230"),n("6b0d")),j=n.n(f);const O=j()(m,[["__scopeId","data-v-3124f26b"]]);t["default"]=O},f230:function(e,t,n){"use strict";n("6b8b")}}]);
//# sourceMappingURL=mobileLogin.d6c2174e.js.map